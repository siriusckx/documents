## 什么是文件共享
1. 文件共享就是同一个文件（同一个文件指的是同一个inode）被多个独立的读写体(不同的文件描述符)去同时（一个打开尚未关闭的同时另一个去操作）操作。
2. 文件共享的意义有很多：譬如我们可以通过文件共享来实现多线程同时操作同一个大文件，以减少文件读写时间，提升效率。

## 文件共享的3种实现方式
1. 文件共享的核心就是怎么弄出来多个文件描述符指向同一个文件。
2. 觉的有3种文件共享的情况：第一种是同一个进程中多次使用open打开同一个文件，第二种是在不同进程中去使用open打开同一个文件（这时候因为两个fd在同不的进程中，所以两个fd的数字可以相同也可以不同），第三种情况是后面要学的，linux系统提供了dup和dup2两个API来进程复制文件描述符。
3. 我们分析文件共享时的核心关注点在于：分别写/读还是接续写/读
## 再论文件描述符
1. 文件描述符的本质是一个数字，这个数字本质上是进程表中文件描述符表的一个表项，进程通过文件描述符作为index去索引查表得到文件表指针，再间接到这个文件对应的文件表。
2. 文件描述符这个数字是open系统调用内部由操作系统自动分配的，操作系统分配这个fd时也不是随意分配，也是遵照一定的规律的，我们现在就要研究这个规律。
3. 操作系统规定，fd从0开始依次增加，fd也是有最大限制的，在linux的早期版本中（0.11）fd最大是20，所以当时一个进程最多允许打开20个文件。linux中文件描述符表是个数组（不是链表），所以这个文件描述符表其实就是一个数组，fd是index，文件表指针是value。
4. 当我们去open时，内核会从文件描述符表中挑选一个最小的未被使用的数字给我们返回，也就是说如果之前fd已经占满了0-9，那么我们下次open得到的一定是10，（但是如果上一个fd得到的是9，下一个不一定是10，这是因为可能前面更小的一个fd已经被close释放掉了）
5. fd中0、1、2已经默认被系统占用了，因此用户进程得到的最小的fd就是3。
6. linux内核占用了0、1、2这三个fd是有用的，当我们运行一个程序得到一个进程时，内部主默认已经打开了3个文件，这三个文件对应的fd就是0、1、2.这三个文件分别叫做stdin、stdout、stderr。也就是标准输入、标准输出、标准错误。
7. 标准输入一般对应的是键盘（可以理解为：0这个fd对应的是键盘的设备文件），标准输出一般是LCD显示器（可以理解为：1对应LCD的设备文件）
8. printf函数其实就是默认输出到标准输出stdout上了。stdio中还有一个函数叫fprintf，这个函数就可以指定输出到哪个文件描述符中。