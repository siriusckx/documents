# 一、内存映射
# 二、虚拟内存空间分布
# 三、内存分配与回收
1. 对小块内存（小于128k）,C标准库使用brk来分配内存。brk()方式的缓存，可以减少缺页异常的发生，提高内存的访问效率。
2. 对大块内存（大于128k）,直接使用内存映射mmap来分配。mmap()方式分配的内存，会在释放时直接归还系统。频繁的内存会导致大量的缺页异常。
3. brk()和mmap()调用后，其实并没有真正分配内顾，这些内存，都只在首次访问时才分配，也就是通过缺页异常进入内核中，再由内核来分配内存。
4. 在内核空间，Linux则通过slab分配器来管理小内存。
5. 在发现内存紧张时，系统会通过一系列机制来回收内存：
   1. 回收缓存
   2. 回收不常访问的内存，把不常用的内存通过交换分区直接写到磁盘中
   3. 杀死进程，内存紧张时系统还会通过OOM(Out of Memory)，直接杀掉占用大量内存的进程。
# 四、如何查看内存使用情况
1. free
   >最后一列的可用内存available,不仅包含未使用内存，还包括了可回收的缓存，所以一般会比未使用内存更大，不过，并不是所有缓存都可以回收，因为有些缓存可能正在使用中。
2. top
   >VIRT是进程虚拟内存大小，包括进程申请过的内存，RES是常驻内存大小，也就是实际使用的物理内存大小，不包括Swap和共享内存，SHR是共享内存大小，比如与其他进程共同使用的共享内存，加载的动态链接库以及程序的代码段等，%MEM是进程使用物理内存占系统总内存百分比。注意：
   1. 虚拟内存通常并不会全部分配物理内存。
   2. 共享内存SHR并不一定是共享的，比如：程序的代码段，非共享的动态链接库，也都算在SHR里面。
